# save_migration.md

- 存档包含 `version` 字段；当前版本 1。
- 加载流程：校验 checksum → 不匹配则尝试最近备份 → 失败则回滚到初始存档模板。
- 迁移规则：
  - 新增字段：填默认值（参考 save_format.json）；旧字段缺失同样补默认。
  - 删除字段：保留但忽略；可在迁移时丢弃。
  - 类型变更：尝试转换（如 int→float），失败则用默认。
- 多槽位：建议 3 槽，手动存档/读档；自动存档写到专用 auto 槽（覆盖）。
- 备份：每次手动存档前复制旧档为 `.bak`；自动存档按时间戳保留 3 份轮换。
- 版本升级示例：
  - v1→v2 若新增 `spirit` 属性，则在迁移时添加 `player.spirit=0`。
  - v1→v2 若新增 `settings.quality_lod`，则默认 `"medium"`。
